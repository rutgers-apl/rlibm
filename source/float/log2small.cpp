#include "float_math.h"

double log2smallInternal(double input) {
    double codyX, xSquare, y;
    codyX = 2 * (input - 1) / (input + 1);
    xSquare = codyX * codyX;
    y = 2.98387164422755202242143468538415618240833282470703125e-01;
    y *= xSquare;
    y += 1.996122250113066820542684354222728870809078216552734375e-01;
    y *= xSquare;
    y += 2.64665103135787116439558985803159885108470916748046875e-01;
    y *= xSquare;
    y += 3.20462962813822971330779409981914795935153961181640625e-01;
    y *= xSquare;
    y += 4.1220281933294511400589499316993169486522674560546875e-01;
    y *= xSquare;
    y += 5.7707795150992868826733683818019926548004150390625e-01;
    y *= xSquare;
    y += 9.617966943187539197168689497630111873149871826171875e-01;
    y *= xSquare;
    y += 2.885390081777253090677959335152991116046905517578125;
    y *= codyX;
    return y;
}

float log2small(float input) {
    double dinput, codyX, xSquare, y;
    dinput = (double)input;
    codyX = (dinput - 1) / (dinput + 1);
    xSquare = codyX * codyX;
    y = 2.98387164422755202242143468538415618240833282470703125e-01;
    y *= xSquare;
    y += 1.996122250113066820542684354222728870809078216552734375e-01;
    y *= xSquare;
    y += 2.64665103135787116439558985803159885108470916748046875e-01;
    y *= xSquare;
    y += 3.20462962813822971330779409981914795935153961181640625e-01;
    y *= xSquare;
    y += 4.1220281933294511400589499316993169486522674560546875e-01;
    y *= xSquare;
    y += 5.7707795150992868826733683818019926548004150390625e-01;
    y *= xSquare;
    y += 9.617966943187539197168689497630111873149871826171875e-01;
    y *= xSquare;
    y += 2.885390081777253090677959335152991116046905517578125;
    y *= codyX;
    return (float)y;
}
